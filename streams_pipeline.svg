<svg xmlns="http://www.w3.org/2000/svg" width="1100" height="460" viewBox="0 0 1100 460">
  <rect x="0" y="0" width="1100" height="460" fill="#ffffff"/>
  <style>
    .txt { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; font-size: 14px; fill: #111111; }
    .title { font-size: 20px; font-weight: 600; }
    .axis { stroke: #111111; stroke-width: 1; fill: none; }
    .box { fill: #ffffff; stroke: #111111; stroke-width: 1.5; rx: 8; ry: 8; }
    .dash { fill: #ffffff; stroke: #111111; stroke-width: 1.5; stroke-dasharray: 6 4; rx: 8; ry: 8; }
    .hint { fill: #444444; }
  </style>

  <!-- Title -->
  <text class="txt title" x="20" y="34">Pipelined GEMM with 4 CUDA Streams</text>
  <!-- Time axis -->
  <line class="axis" x1="140" y1="60" x2="1040" y2="60"/><text class="txt" x="1046" y="65">time →</text>

  <!-- Stream labels -->
  <text class="txt" x="20" y="120">Stream 0</text>
  <text class="txt" x="20" y="190">Stream 1</text>
  <text class="txt" x="20" y="260">Stream 2</text>
  <text class="txt" x="20" y="330">Stream 3</text>

  <!-- Legend -->
  <rect class="box" x="140" y="380" width="28" height="18"/>
  <text class="txt" x="176" y="394">H2D (A,B) copy</text>
  <rect class="dash" x="380" y="380" width="28" height="18"/>
  <text class="txt" x="416" y="394">Compute (matmul kernel)</text>
  <rect class="box" x="720" y="380" width="28" height="18"/>
  <text class="txt" x="756" y="394">D2H (C tile) copy</text>

  <!-- Stream 0 -->
  <rect class="box" x="140" y="100" width="150" height="44"/><text class="txt" x="152" y="126">H2D: A( M0×K )</text>
  <rect class="box" x="302" y="100" width="150" height="44"/><text class="txt" x="314" y="126">H2D: B( K×N0 )</text>
  <rect class="dash" x="464" y="100" width="200" height="44"/><text class="txt" x="476" y="126">Kernel: C00( M0×N0 )</text>
  <rect class="box" x="676" y="100" width="180" height="44"/><text class="txt" x="688" y="126">D2H: C00 → host</text>

  <!-- Stream 1 -->
  <rect class="box" x="200" y="170" width="150" height="44"/><text class="txt" x="212" y="196">H2D: A( M0×K )</text>
  <rect class="box" x="362" y="170" width="150" height="44"/><text class="txt" x="374" y="196">H2D: B( K×N1 )</text>
  <rect class="dash" x="524" y="170" width="200" height="44"/><text class="txt" x="536" y="196">Kernel: C01( M0×N1 )</text>
  <rect class="box" x="736" y="170" width="180" height="44"/><text class="txt" x="748" y="196">D2H: C01 → host</text>

  <!-- Stream 2 -->
  <rect class="box" x="260" y="240" width="150" height="44"/><text class="txt" x="272" y="266">H2D: A( M1×K )</text>
  <rect class="box" x="422" y="240" width="150" height="44"/><text class="txt" x="434" y="266">H2D: B( K×N0 )</text>
  <rect class="dash" x="584" y="240" width="200" height="44"/><text class="txt" x="596" y="266">Kernel: C10( M1×N0 )</text>
  <rect class="box" x="796" y="240" width="180" height="44"/><text class="txt" x="808" y="266">D2H: C10 → host</text>

  <!-- Stream 3 -->
  <rect class="box" x="320" y="310" width="150" height="44"/><text class="txt" x="332" y="336">H2D: A( M1×K )</text>
  <rect class="box" x="482" y="310" width="150" height="44"/><text class="txt" x="494" y="336">H2D: B( K×N1 )</text>
  <rect class="dash" x="644" y="310" width="200" height="44"/><text class="txt" x="656" y="336">Kernel: C11( M1×N1 )</text>
  <rect class="box" x="856" y="310" width="140" height="44"/><text class="txt" x="868" y="336">D2H: C11</text>

  <!-- Footer hint -->
  <text class="txt hint" x="20" y="430">Tip: Each stream runs H2D → compute → D2H for its tile; streams overlap in time.</text>
</svg>
